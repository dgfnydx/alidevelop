!function(e){var n=0,o=8;function i(e){return a(t(r(e),e.length*o))}var c="300000000",s="D88DB9077BE481F747CD4BA24BAD8B23",l="https://api.gxar.com/rest.php";function t(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,a=-271733879,n=-1732584194,o=271733878,i=0;i<e.length;i+=16){var c=r,s=a,l=n,u=o;a=p(a=p(a=p(a=p(a=h(a=h(a=h(a=h(a=d(a=d(a=d(a=d(a=f(a=f(a=f(a=f(a,n=f(n,o=f(o,r=f(r,a,n,o,e[i+0],7,-680876936),a,n,e[i+1],12,-389564586),r,a,e[i+2],17,606105819),o,r,e[i+3],22,-1044525330),n=f(n,o=f(o,r=f(r,a,n,o,e[i+4],7,-176418897),a,n,e[i+5],12,1200080426),r,a,e[i+6],17,-1473231341),o,r,e[i+7],22,-45705983),n=f(n,o=f(o,r=f(r,a,n,o,e[i+8],7,1770035416),a,n,e[i+9],12,-1958414417),r,a,e[i+10],17,-42063),o,r,e[i+11],22,-1990404162),n=f(n,o=f(o,r=f(r,a,n,o,e[i+12],7,1804603682),a,n,e[i+13],12,-40341101),r,a,e[i+14],17,-1502002290),o,r,e[i+15],22,1236535329),n=d(n,o=d(o,r=d(r,a,n,o,e[i+1],5,-165796510),a,n,e[i+6],9,-1069501632),r,a,e[i+11],14,643717713),o,r,e[i+0],20,-373897302),n=d(n,o=d(o,r=d(r,a,n,o,e[i+5],5,-701558691),a,n,e[i+10],9,38016083),r,a,e[i+15],14,-660478335),o,r,e[i+4],20,-405537848),n=d(n,o=d(o,r=d(r,a,n,o,e[i+9],5,568446438),a,n,e[i+14],9,-1019803690),r,a,e[i+3],14,-187363961),o,r,e[i+8],20,1163531501),n=d(n,o=d(o,r=d(r,a,n,o,e[i+13],5,-1444681467),a,n,e[i+2],9,-51403784),r,a,e[i+7],14,1735328473),o,r,e[i+12],20,-1926607734),n=h(n,o=h(o,r=h(r,a,n,o,e[i+5],4,-378558),a,n,e[i+8],11,-2022574463),r,a,e[i+11],16,1839030562),o,r,e[i+14],23,-35309556),n=h(n,o=h(o,r=h(r,a,n,o,e[i+1],4,-1530992060),a,n,e[i+4],11,1272893353),r,a,e[i+7],16,-155497632),o,r,e[i+10],23,-1094730640),n=h(n,o=h(o,r=h(r,a,n,o,e[i+13],4,681279174),a,n,e[i+0],11,-358537222),r,a,e[i+3],16,-722521979),o,r,e[i+6],23,76029189),n=h(n,o=h(o,r=h(r,a,n,o,e[i+9],4,-640364487),a,n,e[i+12],11,-421815835),r,a,e[i+15],16,530742520),o,r,e[i+2],23,-995338651),n=p(n,o=p(o,r=p(r,a,n,o,e[i+0],6,-198630844),a,n,e[i+7],10,1126891415),r,a,e[i+14],15,-1416354905),o,r,e[i+5],21,-57434055),n=p(n,o=p(o,r=p(r,a,n,o,e[i+12],6,1700485571),a,n,e[i+3],10,-1894986606),r,a,e[i+10],15,-1051523),o,r,e[i+1],21,-2054922799),n=p(n,o=p(o,r=p(r,a,n,o,e[i+8],6,1873313359),a,n,e[i+15],10,-30611744),r,a,e[i+6],15,-1560198380),o,r,e[i+13],21,1309151649),n=p(n,o=p(o,r=p(r,a,n,o,e[i+4],6,-145523070),a,n,e[i+11],10,-1120210379),r,a,e[i+2],15,718787259),o,r,e[i+9],21,-343485551),r=v(r,c),a=v(a,s),n=v(n,l),o=v(o,u)}return Array(r,a,n,o)}function u(e,t,r,a,n,o){return v((i=v(v(t,e),v(a,o)))<<(c=n)|i>>>32-c,r);var i,c}function f(e,t,r,a,n,o,i){return u(t&r|~t&a,e,t,n,o,i)}function d(e,t,r,a,n,o,i){return u(t&a|r&~a,e,t,n,o,i)}function h(e,t,r,a,n,o,i){return u(t^r^a,e,t,n,o,i)}function p(e,t,r,a,n,o,i){return u(r^(t|~a),e,t,n,o,i)}function v(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function r(e){for(var t=Array(),r=(1<<o)-1,a=0;a<e.length*o;a+=o)t[a>>5]|=(e.charCodeAt(a/o)&r)<<a%32;return t}function a(e){for(var t=n?"0123456789ABCDEF":"0123456789abcdef",r="",a=0;a<4*e.length;a++)r+=t.charAt(e[a>>2]>>a%4*8+4&15)+t.charAt(e[a>>2]>>a%4*8&15);return r}function g(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(e){var t,r,a,n,o,i,c,s="",l=0;for(e=_utf8_encode(e);l<e.length;)n=(t=e.charCodeAt(l++))>>2,o=(3&t)<<4|(r=e.charCodeAt(l++))>>4,i=(15&r)<<2|(a=e.charCodeAt(l++))>>6,c=63&a,isNaN(r)?i=c=64:isNaN(a)&&(c=64),s=s+_keyStr.charAt(n)+_keyStr.charAt(o)+_keyStr.charAt(i)+_keyStr.charAt(c);return s},this.decode=function(e){var t,r,a,n,o,i,c="",s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)t=_keyStr.indexOf(e.charAt(s++))<<2|(n=_keyStr.indexOf(e.charAt(s++)))>>4,r=(15&n)<<4|(o=_keyStr.indexOf(e.charAt(s++)))>>2,a=(3&o)<<6|(i=_keyStr.indexOf(e.charAt(s++))),c+=String.fromCharCode(t),64!=o&&(c+=String.fromCharCode(r)),64!=i&&(c+=String.fromCharCode(a));return c=_utf8_decode(c)},_utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t+=String.fromCharCode(a):(127<a&&a<2048?t+=String.fromCharCode(a>>6|192):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128)),t+=String.fromCharCode(63&a|128))}return t},_utf8_decode=function(e){for(var t="",r=0,a=c1=c2=0;r<e.length;)(a=e.charCodeAt(r))<128?(t+=String.fromCharCode(a),r++):191<a&&a<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&a)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&a)<<12|(63&c2)<<6|63&c3),r+=3);return t}}var A=function(e){this.env=e.env||null,this.project_id=e.projectId,this.userId=null,this.nickName=null,this.avatar=null,this.gender=null,this.developEnv(),this.userAuth()};A.prototype={developEnv:function(){"test"==this.env&&(c="100000000",s="81B0D880A6BAB8B89EA9233AC767FC4F",l="http://api-sandbox.gxar.com/rest.php")},extend:function(e,t){for(var r in t)e[r]=t[r];return e},series:function(e,t,r){r=r||"0",e+="";var a=new Array(t-e.length+1).join(r)+e;return e.length>=t?e:a},toRadian:function(e){return e*Math.PI/180},toDegree:function(e){return e/Math.PI*180},randomNum:function(e,t,r){for(var a,n=[],o=0;o<e;o++){a=Math.floor(Math.random()*(r-t+1)+t);for(var i=0;i<n.length;i++)a==n[i]&&(a=Math.floor(Math.random()*(r-t+1)+t),i=-1);n.push(a)}return n},getArrayItems:function(e,t){var r=[];for(var a in e)r.push(e[a]);for(var n=[],o=0;o<t&&0<r.length;o++){var i=Math.floor(Math.random()*r.length);n[o]=r[i],r.splice(i,1)}return n},quaternionFromEuler:function(e,t,r){var a=Math.cos(e/2),n=Math.cos(t/2),o=Math.cos(r/2),i=Math.sin(e/2),c=Math.sin(t/2),s=Math.sin(r/2);return[i*n*o+a*c*s,a*c*o-i*n*s,a*n*s+i*c*o,a*n*o-i*c*s]},getDeviceInfo:function(e){var t=AR.getEnvProp("arUserAgent");if(!t)return!1;switch(e){case"platform":var r=t.split(";")[0].split(" ")[1];break;case"device":r=t.split(";")[1].split(" ")[1];break;case"screen":r=t.split(";")[3].split(" ")[1];break;case"screenWidth":r=AR.getEnvProp("screenWidth");break;case"screenHeight":r=AR.getEnvProp("screenHeight")}return r},createAnimation:function(e){AR.create_animation(e.animId,e.nodeId,e.propertyId,e.keyCount,e.keyTimes,e.keyValues,e.type)},frameAnimation:function(e){var t=this,a=1,n=this.extend({startNum:0,seriesLength:3,frameRate:42,repeat:0,frameAnimateCallBack:null},e);function o(){return n.imagePath+(e=n.startNum+"",t.series(e,n.seriesLength,n.filler))+".png";var e}!function t(){for(var r=n.startNum,e=0;e<n.imagesCount;e++)frameTimer=AR.setTimeout(function(){var e=o();AR.set_texture(n.needTextureNode,e,0),"0.0.2"!=__version&&AR.remove_tex_cache(o()),n.startNum++,n.startNum-r>=n.imagesCount&&(a++,n.repeat>=a?(n.startNum=r,t()):0==n.repeat&&(n.startNum=r,t()),"function"==typeof n.callBack&&n.callBack())},e*n.frameRate)}()},countDown:function(n){var o=n.nodeArr.length,i=n.totalTime;e();var c=AR.setInterval(function(){i-=1,e(),n.timeOutCallBack(i,c)},1e3);function e(){var e=(i+"").split(""),t=e.length;if(t<o)for(var r=0;r<o-t;r++)e.unshift("0");else if(o<t)return AR.log("数值溢出"),AR.clearInterval(c),!1;for(var a=0;a<o;a++)AR.set_texture(n.nodeArr[a],n.pathPart1+e[a]+n.pathPart2)}},scoreboard:function(e){var t=e.nodeArr.length,r=new Array(t+1).join(e.maxVal+"")-0,a=e.total;if(a<=r){var n=(a+"").split(""),o=n.length;if(o<t)for(var i=0;i<t-o;i++)n.unshift("0");for(var c=0;c<t;c++)AR.set_texture(e.nodeArr[c],e.pathPart1+n[c]+e.pathPart2)}else for(c=0;c<t;c++)AR.set_texture(e.nodeArr[c],e.pathPart1+e.maxVal+e.pathPart2)},floatVal:function(e){var t=e.val.toFixed(2),r=t.split("."),a=r[0],n=r[1];this.scoreboard({total:a,nodeArr:e.intArr,pathPart1:e.path1,pathPart2:e.path2,maxVal:9}),this.scoreboard({total:n,nodeArr:e.decArr,pathPart1:e.path1,pathPart2:e.path2,maxVal:9}),AR.log(typeof t),AR.log(n)},textRender:function(e){var t="<body><font size="+e.fontSize+" color='"+e.fontColor+"'>"+e.text+"</font></body>";AR.renderText(e.node,t)},setVisible:function(e,t){if("string"==typeof e)AR.set_visible(e,t);else if("object"==typeof e)for(var r=0,a=e.length;r<a;r++)AR.set_visible(e[r],t)},playAnimation:function(e,t,r){if("string"==typeof e)AR.play(e+"#"+t,r);else if("object"==typeof e)for(var a=0;a<e.length;a++)AR.play(e[a]+"#"+t[a],r[a])},btnAnimation:function(e,t,r){var a=AR.get_scale(t);AR.log("box scale:("+a.x+","+a.y+","+a.z+")"),antHelper.createAnimation({animId:e,nodeId:t,propertyId:AR.animation.ANIMATE_SCALE,keyCount:3,keyTimes:[0,80,160],keyValues:[a.x,a.y,a.z,r,r,r,a.x,a.y,a.z],type:AR.animation.CURVE_LINEAR}),AR.play(e+"#Default",1)},videoPlay:function(e,t,r,a){if(e){var n={transparent:!0};AR.set_video(t,r,a,JSON.stringify(n)),AR.play_video(t)}else AR.set_video(t,r,a),AR.play_video(t)},audioPlay:function(e){var t=e.option||null,r=JSON.stringify(t);AR.audio.set(e.audioPath,r),e.autoPlay&&AR.audio.play(e.audioPath)},systemWin:function(e){AR.confirm(e.titleIcon,e.titleText,e.contentIcon,e.contentText,e.buttonText,e.callBack,e.showPocket)},userAuth:function(e){var a=this,t={appId:"2016071501621644",scopeNicks:["auth_base"],extInfo:null,isvAppId:null,authCallback:function(e,t){e?AR.getAuthUserInfo({appId:r.appId,callback:function(e,t){if(e){var r=new g;a.nickName=r.encode(t.userInfo.nickName),a.avatar=t.userInfo.avatar,a.userId=t.userInfo.userId,null!=a.nickName&&""!=a.nickName||(a.nickName="default"),"m"==t.userInfo.gender?a.gender=1:"f"==t.userInfo.gender?a.gender=2:a.gender=0,a.getUserInfos()}else AR.log("getAuthUserInfo failed, "+t.error)}}):AR.log("auth_base failed "+t.error)}},r=this.extend(t,e);AR.auth(r.appId,r.scopeNicks,r.extInfo,r.authCallback,r.isvAppId)},requestInfo:function(e){var t=Math.round((new Date).getTime()/1e3)+"",r=JSON.stringify(e.envProps),a=i(s+"&action="+e.action+"&appid="+c+"&nonce="+t+"&params="+r+"&timestamp="+t).toUpperCase();AR.request({url:l,data:{data:r},header:{"content-type":"application/json",appid:c,action:e.action,nonce:t,timestamp:t,sign:a,program:"AR"},method:e.methodType||"POST",success:e.callBack||null,fail:e.failCallBack||null})},getUserInfos:function(){var e={};e.project_id=this.project_id,e.pid=this.userId,e.nickname=this.nickName,e.avatar=this.avatar,e.gender=this.gender,e.alipay_version=AR.getEnvProp("alipayVersion"),e.system_volume=AR.getEnvProp("systemVolume"),e.resource_version=AR.getEnvProp("alipayBundleVersion"),e.resource_compatible_version=AR.getEnvProp("alipayCompatibleVersion"),e.tracking_mode=AR.getEnvProp("trackMode"),e.runtime_environment=AR.getEnvProp("arUserAgent"),e.source=1,e.source_remark=AR.getEnvProp("rpc_factorName"),this.requestInfo({envProps:e,action:"com.gxar.project.user.logs.record"})},getTicket:function(e){var t={};t.project_id=this.project_id,t.pid=this.userId,t.extras={},t.extras.pid=this.userId,t.extras.avatar=this.avatar,t.extras.gender=this.gender,t.extras.nickname=this.nickName,t.tag=e.ticketTag,this.requestInfo({envProps:t,action:"com.gxar.dev.ticket.get.voucher",callBack:e.callBack||null,failCallBack:e.failCallBack||null})},sendScore:function(e){var t={};t.pid=this.userId,t.score=e.totalPoints,t.tag=e.projectName,t.extras=[],this.requestInfo({envProps:t,action:"com.gxar.games.add",callBack:e.callBack||null,failCallBack:e.failCallBack||null})},collect:function(e){var t={};t.project_id=this.project_id,t.pid=this.userId,t.data={},t.data[e.tag]="1",this.requestInfo({envProps:t,action:"com.gxar.project.user.collect.add",callBack:e.callBack||null,failCallBack:e.failCallBack||null})},redPacket:function(e){var t={};t.setting_id=e.activityId,t.pid=this.userId,t.nickname=this.nickName,t.avatar_url=this.avatar,t.gender=this.gender,t.user_agent=AR.getEnvProp("arUserAgent"),t.is_base64_nickname=1,this.requestInfo({envProps:t,action:"com.gxar.redpack.trigger",callBack:e.callBack||null,failCallBack:e.failCallBack||null})}},"undefined"!=typeof module&&module.exports?module.exports=A:"function"==typeof define&&define.amd?define(function(){return A}):e.AntHelper=A}(this);